\documentclass[a4paper,12pt,oneside,openany,titlepage]{jreport}
%\documentclass[a4paper,12pt,oneside,openany]{jsbook} %3/1追加
%\usepackage{graphicx}
\usepackage[dvipdfmx]{graphicx} %1/28追加
\usepackage{fancyhdr}
\usepackage{comment} %1/26追加
\usepackage{amsmath} %1/26追加
\usepackage{indentfirst} %1/29追加
\usepackage{enumitem} % リストの設定調整用
\pagestyle{fancy}
%↓を追加すると，なぜかうまくいく
\renewcommand{\chaptermark}[1]{\markboth{第\ \thechapter\ 章\,\, #1}{}}
\renewcommand{\bibname}{参考文献}
\renewcommand{\baselinestretch}{1.2} %2/8追加

\pagenumbering{arabic}

\begin{document}

% \frontmatter
% \begin{titlepage}
% 表紙　19-39　3/1追加
% begin{titlepage}
%  \vspace*{7mm}
%  \begin{center}
%    \Large{令和4年度　卒業論文}\\
%     \vspace{40truemm}

%    \LARGE{\textbf{TITLE}}\\
%    \vspace{30truemm}

%    \Large{電気通信大学 情報理工学域 I類}\\
%    \Large{メディア報学プログラム}\\

%    \vspace{15truemm}
%    \LARGE{藤山 仁聖} \vspace{5truemm} \\
%    \large{2024 年 3 月} \\
%   \end{center}
% \end{titlepage}

\newpage

% \begin{comment}
\begin{titlepage}
  \vspace*{5mm}
  \begin{center}
    \vspace{-30truemm}
    \LARGE{令和5年度　卒業論文}\\
    \vspace{20truemm}
    {\fontsize{26pt}{0pt} \selectfont \textbf{高難易度アクションゲームにおける人間らしいAI}}


    \vspace{50truemm}
    \Large{電気通信大学　情報理工学域I類}\\
     \Large{メディア情報学プログラム}\\

    \vspace{25truemm}
    \large
      \begin{equation*}
        \begin{split}
          学籍番号&: 2010150\\
          氏名&: 長内勇輝\\
          \vspace{5truemm} \\
          主任指導教員&:清雄一　教授 \\%（直属の人が一番上）
          指導教員&:田原康之　准教授\\
          提出年月日&:2024 年 mm 月 dd日(月) \\
        \end{split}
      \end{equation*}
    \normalsize
    \normalsize

  \end{center}
\end{titlepage}
\newpage
% \end{comment}

\begin{abstract}
  近年，強化学習技術を活用したゲームAIは将棋や囲碁で人間を凌駕しているが， 
  AIの行動は人間に理解しづらく，面白さを損なうことがある．
  生物学的制約や模倣学習を取り入れ，人間らしいプレイスタイルを持つ
  AIの研究が進められているが，複雑な環境となる3Dアクションゲームを
  題材としていることは少ない．
  本研究では，高難易度アクションゲームに対して
  生物学的制約を加えた強化学習を行い，複雑な環境に対応した
  人間らしいゲームAIの提案を行った．
  その後，生物学的制約を加えたAIとそうでないAIのプレイ映像を見せ，
  主観評価を行う被験者実験により人間らしさを評価した．

\end{abstract}

\tableofcontents
\listoftables
\listoffigures
\newpage

%第一章の記述

\chapter{はじめに}
\thispagestyle{fancy}
\lhead{\leftmark}
\rhead{\thepage}
\renewcommand{\headrulewidth}{1pt}

\section{背景}
強化学習技術により，将棋や囲碁などのゲームにおいて人間を凌駕するAIが開発されてきた
．しかし，これらのゲームAIは人間に理解できないような行動や機械的に見える行動をとり，
面白さを損なう場合がある．
そこで近年では，生物学的制約を設けて人間らしいプレイをするゲーム
AIの研究\cite{morita}\cite{tutii}
や，%マリオ，テトリス
模倣学習により人間らしいプレイスタイルをとるゲームAIの研究
\cite{fujiyama}
が行われている．
このような，人間らしいゲームAIは，人間プレイヤを楽しませたり，
難易度調整に利用したりすることが期待されている．

また近年では，プレイヤに難しい操作を求める
高難易度アクションゲームが人気を博している.
高難易度アクションゲームは難易度の調整が重要で，
プレイヤが丁度良く苦戦する難易度にすることが
望ましいとされている．難易度の調整には人間による
テストプレイが必要だが，人間らしいゲームAIがあれば
そのコストを削減することができる．
しかし，高難易度アクションゲームのような3Dアクションゲーム
では，人間らしいAIの研究がほとんどされていないのが現状である．
既存手法では高難易度アクションゲームが持つ複雑な要素に対応できないと
考えられる．
\newpage

\section{高難易度アクションゲーム}
本研究における高難易度アクションゲームとはDARKSOULS\cite{darksouls}
や仁王\cite{niou}のようなゲームを指す．難易度が高いことにより，
プレイヤが何度もゲームオーバーになることから，死にゲーと呼ばれることもある．
基本動作として攻撃，回避，ガードが挙げられ，ゲームの種類によって
様々なアクションが可能となる．

\section{生物学的制約}
生物学的制約とは人間が生きる上で起こりうる身体的
な制約や生き延びようとする心理的な制約のことである．
生物学的制約を加えることによって人間がしない
ような，正確すぎる操作，素早すぎる反応，不自然な
一定の行動をゲームAIがすることを抑制する．
加えてミスをさせることや弱くさせるといった
調整方法をした際に発生しうる「わざとらしさ」
やそれに伴う「つまらなさ」を抑制することができる．

\section{論文の構成}
%TODO:
本論文は第1章から第何章で構成されている．
第2章では関連研究

\newpage

\chapter{関連研究}
 \thispagestyle{fancy}
 \lhead{\leftmark}
 \rhead{\thepage}
 \renewcommand{\headrulewidth}{1pt}

 \section{DQNと生物学的制約を用いた人間らしい振る舞いのムゲームAI}
 森田はInfinite Mario Bros.で人間らしい振る舞いをするゲームAI
 をDeep Q-Network(DQN)に生物学的制約を加えることで実現させた\cite{morita}．
 生物学的制約として藤井らの先行研究\cite{FuJi_en}
 で使用された「揺らぎ」「遅れ」「疲れ」
 の他，新たに「混乱」「油断」を追加し，「疲れ」をより人間に近くなるように改良した．
 検証として「混乱」と「油断」に対しての実験，改良した「疲れ」に対しての実験
 の2つを行った．それぞれに対して10人の被験者による被験者実験の主観評価
 は提案手法を用いたゲームAIの方が先行研究の手法のみを用いたゲームAI
 よりも，より人間らしい振る舞いをしていると評価された．
 しかし，Infinite Mario Bros.にはスタミナのような
 プレイヤが管理するステータスが存在しなく，
 また，移動，ダッシュ，ジャンプのみの行動で構成されているため，
 ステータスや行動の種類が多い高難易度アクションゲームに
 手法をそのまま適応させることは難しい．
 
 \newpage

 \section{高難易度アクションゲームにおけるプレイヤ
 に気づかれにくい難易度調整手法}\label{teigi}
 荒木らは高難易度アクションゲームにおいて，敵の攻撃状態への遷移確率
 や，攻撃ヒット時のノックバック距離などのプレイヤ
 に気づかれにくい項目を調整することで，プレイヤに察知されること
 なく難易度を調整する方法を提案した．\cite{dif-action}
 
 高難易度アクションゲームの要件を以下のように定めて，
 環境であるゲームを作成した．
 {
\begin{itemize}[itemsep=1pt, leftmargin=27pt, labelsep=5pt, parsep=0pt]
  \item ステータスが高い(HP，攻撃力等)
  \item スーパーアーマーがついた行動をする(攻撃を受けても
  行動が中断されない)
  \item 回復を阻害してくる(回復中に攻撃してくる，
  回復できないように距離を常に詰めてくる)
  \item 盾を構える機会が多い(隙が少ない)
  \item 強力な連続攻撃をする(対処をしないと致命的な攻撃)
  \item 攻撃範囲が広い(敵自体も大きい)
\end{itemize}
}
\newpage



\chapter{オリジナル高難易度アクションゲーム}
 \thispagestyle{fancy}
 \lhead{\leftmark}
 \rhead{\thepage}
 \renewcommand{\headrulewidth}{1pt}


 本研究で扱う環境は，実際に発売されている
 高難易度アクションゲームを参考に，筆者がUnityで作成した
 3Dアクションゲームである．
 
 \section{ゲームの要件}
 高難易度アクションゲームの要件は\ref{teigi}節のもの
 を参考に以下のように定めた．
 {
 \begin{itemize}[itemsep=1pt, leftmargin=27pt, labelsep=5pt, parsep=0pt]
   \item ステータスが高い(HP，攻撃力等)
   \item 常時スーパーアーマー(攻撃を受けても行動が中断されない)
   \item 回復を阻害してくる(回復中に攻撃してくる，
   遠距離からの攻撃)
   \item ディレイのかかった一撃で瀕死となる攻撃
   \item 攻撃範囲が広い
 \end{itemize}
 }
 
 \section{基本操作}
 基本操作は以下の行動を可能とした．
 {
 \begin{itemize}[itemsep=1pt, leftmargin=27pt, labelsep=5pt, parsep=0pt]
   \item 右手の剣を使った攻撃(連続で攻撃を入力すると派生攻撃が出る)
   \item 左手の盾を構えてガード(ガード時にスタミナが0になるとのけぞる)
   \item 転がりながらの回避(直後に攻撃を入力すると派生攻撃が出る)
   \item バックステップ(移動入力がニュートラルの状態で回避を入力)
   \item アイテムを使った回復
 \end{itemize}
 }
 
 探索や索敵などには焦点を当てず，戦闘のみの学習を行うため，
 常時敵をロックオンしている状態とした．
 
 \section{環境・パラメータ}
 実験環境は図\ref{kankyou}で表す．30*30のフィールドに操作
 可能なPlayerとフローチャートを元に実装したEnemyのみを
 配置し，PlayerかEnemyのHPが0になった時点で1ゲームが終了する．
 PlayerのHPは100，EnemyのHPは300，
 Playerのスタミナは150,回復回数は3回，
 一度の回復で60のHPを回復する．
 
 
 \begin{figure}[h]
   \begin{center}
     \includegraphics[width=8.4cm]{ActionGameImage.png}
     \caption{高難易度アクションゲーム環境}
     \label{kankyou}
   \end{center}
 \end{figure}
 
 画面上UIにおいても実際のゲームを参考にし，
 Player，EnemyそれぞれのHPとPlayerのスタミナをバーによって
 表示し，残りの回復数と使用している武器の情報を画面左下に表示した．
 
 
 
 \section{Enemyの実装}
 戦闘のみの学習を行うため，Enemyはあらかじめ
 Playerを発見している状態とした．
 Enemyは距離によって行動の選択肢を分け，その中から
 ランダムに選択する．行動の選択肢を図\ref{action_choice}
 に示す．
 
 \begin{figure}[h]
   \begin{center}
     \includegraphics[width=9cm]{action_choice.png}
     \caption{Enemyの行動選択肢}
     \label{action_choice}
   \end{center}
 \end{figure}
 
 Enemyのフローチャートを図\ref{enemy_huro}に示す．Enemy
 はゲームが始まるとPlayerに近づき，近距離行動の範囲
 に入ったとき行動を始める．行動後はPlayer-Enemy間の距離の判定
 を行い，再びランダムに行動をする．以上のことゲーム終了まで繰り返す．
 
 \begin{figure}[h]
   \begin{center}
     \includegraphics[width=8cm]{enemy_huro.png}
     \caption{Enemyのフローチャート}
     \label{enemy_huro}
   \end{center}
 \end{figure}

\chapter{提案手法}
 \thispagestyle{fancy}
 \lhead{\leftmark}
 \rhead{\thepage}
 \renewcommand{\headrulewidth}{1pt}

 本研究では，作成した高難易度アクションゲームの環境において，
 The Unity Machine Learning Agents Toolkit
 (ML-Agents)の強化学習に生物学的制約を加えることで，
 人間らしさとゲームスキルの高さを兼ね備えたゲームAIの生成
 手法を提案する．
 
 \section{報酬}
 強化学習に用いる報酬は次のように設定した．
 ここでの距離とはPlayerとEnemy間の距離とする．
 %TODO:なぜその報酬を設定したのか説明を入れてもいいかも
 
 \begin{itemize}[itemsep=1pt, leftmargin=27pt, labelsep=5pt, parsep=0pt]
   \item 回復量 * (0.08)
   \item 余剰回復量 * (-0.5)
   \item Playerへのダメージ * (-0.2)
   \item Playerが回避したダメージ * (-0.2)
   \item Enemyへのダメージ * (0.1)
   \item Playerがガードしたダメージ * (0.05)
   \item 攻撃時，距離が4.5以上のとき -4
   \item 攻撃時，距離が1以上2.5以下のとき 0.1
   \item 回復時，距離が3以下のとき -3
   \item 回復時，距離が10以上のとき 0.1
   \item 距離により攻撃を回避をしたとき 0.1
 \end{itemize}
 
 
 \section{観察値}
 観察値は以下のように設定した．
 観察値は人間がプレイしている場合に取得するものと，
 プレイスキルを高めるために必要なものを採用した．
 HP，スタミナ，回復残数，カメラによる画像は，人間が
 プレイしたときに取得する情報である．
 Player,Enemyの座標はPlayer-Enemy間の距離が
 Enemyの攻撃パターンや行動による報酬に関与するため，
 必要であると判断し採用した．
 Enemyの攻撃番号は回避の成功率を高める狙いで採用した．
 
 \begin{itemize}[itemsep=1pt, leftmargin=27pt, labelsep=5pt, parsep=0pt]
   \item Playerの座標 x,y,z
   \item Enemyの座標 x,y,z
   \item PlayerのHP
   \item EnemyのHP
   \item Playerのスタミナ
   \item Playerの回復残数  
   \item Enemyの攻撃番号
   \item Playerに追従するカメラによる画像(256*144)
 \end{itemize}
 
 
 \section{既存の生物学的制約の導入}
 先行研究\cite{morita}にあった生物学的制約のうち「ゆらぎ」「遅れ」「疲れ」「油断」を
 導入する．
 \begin{enumerate}
   \item ゆらぎ(見間違い・操作ミスなど): 人間プレイヤは
   全ての情報を正確に捉えることは不可能であり，また常に正確な操作をすること
   も不可能である．これを再現するためにゲームAIが観測する情報に対してガウスノイズ
   を付与した．
   \item 遅れ(人間の反射神経): 人間プレイヤは観察した情報
   から実際に操作を行うまでに遅れが発生する．これを再現するために
   アクション決定間隔を数フレーム遅延させた．
   \item 疲れ(キー操作によるもの): 人間プレイヤはコントローラを
   操作することにより疲れが生じ，徐々にパフォーマンスが低下する．
   これを再現するために，キー操作の変更ごとに「ゆらぎ」，「遅れ」の
   パラメータの上昇を行った．
   \item 油断: 人間プレイヤは順調にプレイができているときに
   注意が疎かになり，いつもとは違う行動をとってしまう．これを再現するために
   Playerが一定時間ダメージを受けていない状態でEnemyに攻撃が成功したときから
   次にPlayerがダメージを受けるまでの間を油断状態とし，油断状態では
   ランダム行動の選択確率を$5\%$上昇させた．
   また，ランダム行動時に何もしないダミーの選択肢を混ぜた．
 \end{enumerate}
 
 先行研究では「混乱」をPlayerの周りのオブジェクト数が一定数
 を超えたときに「揺らぎ」と「遅れ」のパラメータを増加することで
 導入していたが，本環境では一対一の戦闘を想定しているため除外した．
 また，高難易度アクションゲームは何度もゲームオーバーになることを想定しているため，
 疲労が蓄積しやすい考えられる．よって「疲れ」の値はゲームが終了しても
 引き継ぐようにし，学習の1エピソードの区切りである
 10ゲーム終了時点でリセットされるようにした．
 これにより，疲れが蓄積される過程を学習させることができるのではないかと考えた．
 
 
 \section{新しい生物学的制約の検討}
 既存の生物学的制約のみでは複雑な環境である
 高難易度アクションゲームに対応することは難しい．
 既存手法に加えて検討する「緊張」「節約」「リスク回避」は
 以下のような理由で採用する．
 
 \begin{enumerate}
   \item 緊張: 緊張はストレス反応の一種であり，人間は
         ストレスや
         プレッシャーがかかると前頭前野の機能が低下し，
         普段しない行動をしてしまうことがある．
         スポーツの分野ではクライマックスシーンで
         非合理的な行動をすることがみられる．
         ゲームも同様に勝敗が決定するような場面では，普段しない
         行動をとってしまうと考えられるため採用した．
 
         %スポーツ心理学の分野では競技のクライマックスシーン
         %での非合理な行動　TODO:ここら辺の論文探したい
   \item 節約: 人間の行動における心理的バイアス
         の一つに保有効果(Endowment effect)があり，所有している
         ものに対して，そのものの性質だけでなく，所有する
         ことによって得られる精神的な報酬にも価値を見出すというものである．
         この現象はゲームにおいても有効であり，貴重なアイテム
         を使わず，最後まで温存するラストエリクサー症候群
         と呼ばれるものがある．
         よって高難易度アクションゲームにおいても
         回復薬などのアイテムやスタミナなどの
         後に必要となるかもしれないものを温存する行動が
         人間らしさに繋がると考え採用した．
 
 
   \item リスク回避: 
         人間は危険が迫ると扁桃体が活性化され，
         回避行動が促進されると言われている．また，
         危機的状況に陥ると，損失回避バイアスが
         働きやすくなると言われていて，利益を得る行動
         よりも損失を避ける行動が優先される．
         
         HPやスタミナが少ない状態の場合，敵から
         すぐに離れ，一度状況を立て直すプレイヤがみられるため．
         
 \end{enumerate}
 
 
 \section{新しい生物学的制約の導入}
 「緊張」「節約」「リスク回避」は次のように導入した．
 \begin{enumerate}
   \item 緊張: PlayerかEnemyのHPが30以下のときに緊張状態とし，
   Playerが緊張状態のとき，ランダム行動選択確率を5$\%$増加させた．
         
   \item 節約: Playerのスタミナが20以下のときに-0.05，
   Playerのスタミナが20より大きく40以下のときに-0.03，
   Playerのスタミナが70以上100以下のときに0.02の報酬をそれぞれ与えた．
   加えて回復薬を使用時，最後の一つだった場合に-1の報酬を与えた．        
         
   \item リスク回避: PlayerのHPかスタミナが30以下のときに，
   Player-Enemy間の距離が3以下だった場合-0.02の報酬を与えた．
 
 \end{enumerate}
 


\chapter{実験}
 \thispagestyle{fancy}
 \lhead{\leftmark}
 \rhead{\thepage}
 \renewcommand{\headrulewidth}{1pt}

 本実験では，ゲームAIに生物学的制約を含まないもの，
 含むもの(「ゆらぎ」「遅れ」「疲れ」「油断」)，新しい
 生物学的制約の内１つを含むもの(「緊張」「節約」「リスク回避」)，
 新しい生物学的制約の内2つを組み合わせたもの，
 新しい生物学的制約を全て含むもの
 をML-Agentsで学習させ，被験者実験によって人間らしさを評価する．
 実験の被験者として高難易度アクションゲームを10時間以上プレイ
 したことがある4人とプレイしたことがない6人の合計10人を集めた．
 
 
 実験で用いられるプレイ映像を表\ref{eizo}に示す．
 生物学的制約を組み合わせた9つのゲームAIと人間によるプレイ映像を用いる．
 それぞれのプレイ映像は「疲れ」の影響がわかりやすくするため，
 10ゲームの後半1分程度をトリミングした．
 
 被験者実験は以下の流れで行う．最初に著者がプレイしている
 1分程度の映像を見せ，人間が高難易度アクションゲームをプレイしている
 イメージを被験者に持たせる．
 このプレイ映像では高難易度アクションゲームの攻略において有効とされる，スタミナの
 管理をしてスタミナをできるだけ枯渇しないようにすること，
 間合いの管理をして攻撃を回避すること，
 敵から離れたときまたは隙が生まれたときに回復すること，
 ガードよりも回避を優先すること
 を意識した．
 
 次に被験者にあらかじめ録画された9つのゲームAIまたは人間のプレイ映像
 を見てもらい，7段階で2つの質問「このゲームAIは人間らしい動きをしているか」
 (1が最も機械的な動きを，7が最も人間らしい動きをしているとする)，
 「このゲームAIはどのくらいのゲームスキルを持っているか」
 (1が初心者，7が上級者とする)に答えてもらう．
 加えてそれぞれの映像に対して自由記述欄を設けた．
 
 \begin{table}[!ht]
   \centering
   \caption{実験で用いられるプレイ映像}
   \label{eizo}
   \begin{tabular}{c|c|c}    
   \hline
       ラベル & 生物学的制約 & 映像の時間 \\ \hline
       [None] &  なし & 60秒 \\ \hline
       [Exist] & 既存のみ & 62秒 \\ \hline
       [Exist,Ner] & 既存,緊張 & 59秒 \\ \hline
       [Exist,Save] & 既存,節約 & 60秒 \\ \hline
       [Exist,Risk] & 既存,リスク回避 & 64秒 \\ \hline
       [Exist,Ner,Save] & 既存,緊張,節約 & 62秒 \\ \hline
       [Exist,Ner,Risk] & 既存,緊張,リスク回避 & 60秒 \\ \hline
       [Exist,Save,Risk] & 既存,節約,リスク回避 & 65秒 \\ \hline
       [Exist,Ner,Save,Risk] & 既存,緊張,節約,リスク回避 & 65秒 \\ \hline
       [Player] & ー & 60秒 \\ \hline
   \end{tabular}
 \end{table}
 
 \section{評価結果}
 人間らしさとゲームスキルの評価結果を表\ref{kekka}に示す．
 初めに既存の生物学的制約を加えたものと何も加えていないものを比較する．
 [Exist]は人間らしさの評価において[None]を上回ったが，
 ゲームスキルの評価においては下回った結果となった．
 
 次に既存の生物学的制約に「緊張」「節約」「リスク回避」の中から一つを加えたものと，
 既存の生物学的制約のみのものを比較する．
 [Exist，Save]は人間らしさ，ゲームスキルの両方において[Exist]の評価を上回ったが，
 [Exist，Ner]と[Exist，Risk]は人間らしさ，ゲームスキルの両方において[Exist]の評価を
 下回り，また[None]と比較しても同様に両方の評価が下回った結果となった．
 
 次に既存の生物学的制約に新しい生物学的制約を複数組み合わせたものを
 既存のものと比較する．人間らしさ，ゲームスキル両方において[Exist，Save，Risk]
 の評価が最も高く，[Exist]の評価と比較しても上回っている．
 また，[Exist，Ner，Save]と[Exist，Ner，Risk]も人間らしさ，ゲームスキルの両方で
 [Exist]の評価を上回っている．[Exist，Ner，Save，Risk]は新しい生物学的制約を２つ
 組み合わせたものの全てと比較して，両方の項目で評価が低かった．[Exist]と比較すると，
 人間らしさの評価は等しく，ゲームスキルの評価は0.1高かった．
 
 最後に人間によるプレイとAIによるプレイ全体の評価を比較する．
 [Player]は人間らしさ，ゲームスキルの両方で全てのゲームAIより高く評価された．
 
 
 \begin{table}[!ht]
   \centering
   \caption{人間らしさ，ゲームスキルの評価}
   \label{kekka}
   \begin{tabular}{c|c|c}
   \hline
       ラベル & 人間らしさ & ゲームスキル \\ \hline
       [None] & 2.3 & 2.5 \\ \hline
       [Exist] & 2.6 & 2.4 \\ \hline
       [Exist,Ner] & 2.0 & 2.0 \\ \hline
       [Exist,Save] & 2.7 & 2.8 \\ \hline
       [Exist,Risk] & 1.6 & 1.5 \\ \hline
       [Exist,Ner,Save] & 3.1 & 2.6 \\ \hline
       [Exist,Ner,Risk] & 3.4 & 3.0 \\ \hline
       [Exist,Save,Risk] & 3.6 & 3.1 \\ \hline
       [Exist,Ner,Save,Risk] & 2.6 & 2.5 \\ \hline
       [Player] & 5.6 & 5.7 \\ \hline
   \end{tabular}
 \end{table}
 
 \section{自由記述}
 [None]は敵の行動に関係なく一定回数の攻撃をした後に回避をする動作
 を繰り返しているように見えた部分が機械的に見えたと評価された．
 [Exist]は何もしない状態で攻撃を受けている部分が機械的に見えたと評価された．
 [Exist, Ner]は敵の目の前で回復行動を行う点が，機械らしくまた初心者らしい
 と評価された．
 [Exist，Save]は盾と回避を多用している部分がゲームスキルが高いと評価された．
 最も評価が低かった[Exit，Risk]には敵との距離が離れているにも関わらず，
 攻撃を続けている部分が機械らしいというコメントが3件あった．
 [Player]を除いて最も評価が高かった[Exit，Save，Risk]は
 攻撃に対応して回避ができている部分が高く評価されていた．
 次に評価が高かった[Exit，Ner，Risk]敵の攻撃の後隙に
 回復や攻撃を狙う点が高く評価された．
 [Exist， Ner，Save，Risk]は盾を構えながらの移動が
 人間らしいと評価された．
 
 [Player]以外のゲームAI全体としてスタミナの管理ができていない点や，
 Enemyに当たらない位置で攻撃をしている部分が人間らしくないと評価され，
 [Player]はスタミナの管理や間合いの管理ができている点が
 人間らしいと評価された．


\chapter{考察}
\thispagestyle{fancy}
\lhead{\leftmark}
\rhead{\thepage}
\renewcommand{\headrulewidth}{1pt}

\section{生物学的制約を加えた影響}
最初に生物学的制約がゲームAIにどのような影響を
与えたか考察する．
既存の生物学的制約(「ゆらぎ」「遅れ」「疲れ」「油断」)
を加えた[Exit]は生物学的制約を含まない[None]よりわずかに
人間らしいと評価されたがゲームスキルが低く評価された．
これは生物学的制約の特性上Playerを弱くするように働くため
と考えられる．[Exit]の人間らしさの評価は[None]より0.3高い理由は，
生物学的制約によって，
[None]が機械的であると評価された単調な動作の繰り返し
を抑えることができたからではないかと考えられる．
しかし「ゆらぎ」「遅れ」「疲れ」はわかりやすく行動に表れる制約では
なく，また「油断」は限定的な状況における制約のためその変化を
感じにくいのではないかと考えられる．

新しい生物学的制約から1つのみ加えたものの内「緊張」と「リスク回避」
を加えたものは既存手法より評価が低かったが，「節約」は既存手法より
高く評価された．また，スタミナ管理に関するコメントが4件あった
ことから「節約」が高難易度アクションゲームにおいて
重要な要素であると推察できる．
スタミナを管理しようとすると，攻撃，回避，ガードを行わない
ようにしなければならなく，それによって機械的に見える同じ動作の
繰り返しを抑制できたのではないかと考えられる．
アイテムの節約に関しての自由記述はなく，回復アイテムのみでの状況では
評価に影響は少ないと考えられ，攻撃力やスタミナの回復速度を
一時的に高めるアイテムなど種類を増やすことによって重要性が増す
可能性がある．

「緊張」のみを追加したものは敵の目前で回復を行っていることが，人間らし
くないと評価されたが，敵との距離が近い状態で回復を行うことに負の
報酬を与えているため，ランダム行動が作用しているのではないかと考えられる．
「リスク回避」のみを追加したものは，敵から離れた状態で攻撃をしている行動が
機械的に見えると評価されたが，これは「リスク回避」の制約がHPかスタミナが低い状態
では距離を取ろうとするためだと考えられる．
また「節約」がないことにより，スタミナが枯渇している状態でいることが多く，
距離を取ることが優先されやすいのではないかと思われる．
実際に「節約」と「リスク回避」を組み合わせた[Exist，Save，Risk]は
[Player]を除いて最も人間らしいと評価されており，「リスク回避」単体
で生じる機械らしさを打ち消すことができているのではないかと考えられる．
[Exist，Ner，Save，Risk]が新しい生物学的制約を２つ加えたものより
評価が低かった理由は[Exist，Ner]の評価が低かったことと同様に，
緊張の制約が人間らしさを損なっているからだと思われる．

本研究のゲームAI全体の評価として，
生物学的制約を加えることによって人間らしさとゲームスキル
が向上することを示せたが，
敵に当たらない位置での攻撃やスタミナの枯渇など問題がある．
報酬の調整や学習方法の変更によって
改善の余地がある．


\section{高難易度アクションゲームの特性}
次に高難易度アクションゲームの特性上生じる影響について考察する．
高難易度アクションゲームは難しいことを前提としているため，
プレイしたことがあるプレイヤほどゲームスキルの高さに
人間らしさを感じる可能性がある．
実際に表\ref{kekka}ではゲームスキルと人間らしさの評価は
比例傾向にある．
ゲームスキルの高さと人間らしさが比例する場合，
生物学的制約によって弱くなるよう学習させる方法は
適しておらず，ゲームスキルを高めることだけに焦点
を当てた方が，結果的に人間らしいと評価される可能性がある．



%\subsection{加えた生物学的制約は適しているか}
%本研究で加えた「緊張」「節約」「リスク回避」単に加えるだけではだめかも緊張が高いゲームスキルを前提としている

%設定した報酬についての考察を書いてもいいかも

\section{実験の方法}
最後に実験の方法について考察する．本研究では，
被験者実験による主観評価実験によって人間らしさを評価したが，
被験者ごとに感じ方がそれぞれ違うため，被験者実験によって
結果が大きく異なってしまう可能性があり，
説得力が低い結果であるという問題が生じる．
この問題を解決するためには人間らしさを定量的に
定義して，実験を行う必要があるが，人間らしさは
曖昧さを常に含むものであり，定量的に見ることは難しい．
実際に先行研究においても，本研究と同様に，被験者実験
のみを採用している．人間らしさを定量的に定義し，
評価できるようになれば，評価の信憑性が増し，
人間らしいAIの分野の大きな貢献となるだろうと思われる．

本研究では，「疲れ」を考慮し，10ゲームの後半1分を
トリミングした映像を被験者に見せたが，
トリミングした部分によってAIの動作は異なるため，
感じ方も異なる可能性があり，評価の説得力は低い．


\chapter{おわりに}
\thispagestyle{fancy}
\lhead{\leftmark}
\rhead{\thepage}
\renewcommand{\headrulewidth}{1pt}

\section{本研究のまとめ}
本研究では高難易度アクションゲームの環境において，
生物学的制約を加えたML-Agentsによって人間らしい
動きをしたゲームAIの実現ができるか検証した．
「ゆらぎ」「遅れ」「疲れ」「油断」に新しく「緊張」
「節約」「リスク回避」の生物学制約を加えることによって，
人間らしさの評価は高くなったが，人間によるプレイと比較すると
評価の差は大きく，スタミナの管理や間合いの管理をできていない
などの機械的な挙動が目立ち，プレイヤスキルの観点でも劣っている．

\section{今後の展望}
今後の課題はゲームスキルの向上である．
高難易度アクションゲームにおいてはゲームスキルの高さが
人間らしさに関係していると考えられ，
高いゲームスキルを持つAIに対して生物学的制約を
加えたものと，加えてないものを比較する必要がある．
ゲームスキルの向上方法として，報酬の見直しや
学習方法の変更があり，さらなる検討が必要である．
 


\newpage

\addcontentsline{toc}{chapter}{謝辞}

\chapter*{謝辞}
\thispagestyle{plain}
\lhead{\leftmark}
\rhead{\thepage}
\renewcommand{\headrulewidth}{1pt}
本文

\newpage

\addcontentsline{toc}{chapter}{\bibname}
% \chapter*{\bibname}
% \thispagestyle{plain}
% \lhead{\leftmark}
% \rhead{\thepage}
% \renewcommand{\headrulewidth}{1pt}
\begin{thebibliography}{99}
\bibitem{morita}   森田 隆弘，DQNと生物学的制約を用いた
人間らしい振る舞いのゲームAI，
第124回人工知能基本問題研究会(SIG-FPAI)

\bibitem{tutii}  土居 海里，竹内 聖悟，
生物学的制約による人間らしい対戦テトリスAIの研究，
ゲームプログラミングワークショップ2023論文集，pp. 42-47，
2023．

\bibitem{fujiyama} 藤山 仁聖，清 雄一，田原 康之，大須賀 昭彦，
マルチプレイヤRPGにおいて人間らしいプレイスタイルをとるゲームAIの提案，
第16回データ工学と情報マネジメントに関するフォーラム，
2024．

\bibitem{darksouls} DARKSOULS https://www.darksouls.jp
\bibitem{niou} 仁王 https://www.gamecity.ne.jp/nioh/
\bibitem{dif-action} 荒木 海斗，三上 浩司，兼松 祥央，松吉 俊，
高難易度アクションゲームにおけるプレイヤー
に気づかれにくい難易度調整手法，
エンタテインメントコンピューティングシンポジウム(EC2023)，
2023．


\bibitem{FuJi_en} N. FUjii，Y. Sato，H. Wakama，K. Kazai and H. Katayose，
Proc. ACE, LNCS, vol. 8253, pp. 61-76，
Evaluating Human-like Behaviors of Video-Game Agents Autonomously Acquired with Biological Constraints，
2013．

\bibitem{stress}

\end{thebibliography}

\newpage

\addcontentsline{toc}{chapter}{研究業績}
\chapter*{研究業績}
\thispagestyle{plain}
\lhead{\leftmark}
\rhead{\thepage}
\renewcommand{\headrulewidth}{1pt}
 \section*{研究会}
 氏名, 清 雄一, 田原 康之, 大須賀 昭彦: タイトル,  学会名, 2023

\end{document}
